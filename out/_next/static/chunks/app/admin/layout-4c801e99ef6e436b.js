(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{16469:function(t,e,s){Promise.resolve().then(s.bind(s,30789))},30789:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return o}});var n=s(57437),r=s(2265),i=s(14362),u=s(99376),a=t=>{let{children:e,requireAdmin:s=!1}=t,{user:a,isAdmin:o,loading:c}=(0,i.a)(),l=(0,u.useRouter)();return((0,r.useEffect)(()=>{c||(a?s&&!o&&l.push("/"):l.push("/auth"))},[a,o,c,l,s]),c)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):a&&(!s||o)?(0,n.jsx)(n.Fragment,{children:e}):null};function o(t){let{children:e}=t;return(0,n.jsx)(a,{requireAdmin:!0,children:e})}},99376:function(t,e,s){"use strict";var n=s(35475);s.o(n,"useRouter")&&s.d(e,{useRouter:function(){return n.useRouter}})},14362:function(t,e,s){"use strict";s.d(e,{H:function(){return c},a:function(){return l}});var n=s(57437),r=s(2265),i=s(1072),u=s(99376),a=s(23340);let o=(0,r.createContext)(void 0),c=t=>{let{children:e}=t,[s,c]=(0,r.useState)(null),[l,d]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),[f,S]=(0,r.useState)(!0),{toast:m}=(0,a.pm)(),v=(0,u.useRouter)();(0,r.useEffect)(()=>{let{data:{subscription:t}}=i.O.auth.onAuthStateChange((t,e)=>{var s;d(e),c(null!==(s=null==e?void 0:e.user)&&void 0!==s?s:null),(null==e?void 0:e.user)?setTimeout(()=>{g(e.user.id)},0):p(!1),S(!1)});return i.O.auth.getSession().then(t=>{var e;let{data:{session:s}}=t;d(s),c(null!==(e=null==s?void 0:s.user)&&void 0!==e?e:null),(null==s?void 0:s.user)&&g(s.user.id),S(!1)}),()=>t.unsubscribe()},[]);let g=async t=>{try{let{data:e,error:s}=await i.O.from("user_roles").select("role").eq("user_id",t).eq("role","admin").maybeSingle();!s&&e?p(!0):p(!1)}catch(t){console.error("Error checking admin status:",t),p(!1)}},I=async(t,e)=>{let{error:s}=await i.O.auth.signInWithPassword({email:t,password:e});return s?m({title:"Error signing in",description:s.message,variant:"destructive"}):(m({title:"Success!",description:"You have been signed in successfully."}),v.push("/")),{error:s}},T=async(t,e,s)=>{let n="".concat(window.location.origin,"/"),{error:r}=await i.O.auth.signUp({email:t,password:e,options:{emailRedirectTo:n,data:{full_name:s}}});return r?m({title:"Error signing up",description:r.message,variant:"destructive"}):(m({title:"Success!",description:"Your account has been created successfully."}),v.push("/")),{error:r}},E=async()=>{let{error:t}=await i.O.auth.signOut();t?m({title:"Error signing out",description:t.message,variant:"destructive"}):(m({title:"Signed out",description:"You have been signed out successfully."}),v.push("/"))};return(0,n.jsx)(o.Provider,{value:{user:s,session:l,isAdmin:h,loading:f,signIn:I,signUp:T,signOut:E},children:e})},l=()=>{let t=(0,r.useContext)(o);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},23340:function(t,e,s){"use strict";s.d(e,{pm:function(){return h}});var n=s(2265);let r=0,i=new Map,u=t=>{if(i.has(t))return;let e=setTimeout(()=>{i.delete(t),l({type:"REMOVE_TOAST",toastId:t})},1e6);i.set(t,e)},a=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:s}=e;return s?u(s):t.toasts.forEach(t=>{u(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===s||void 0===s?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},o=[],c={toasts:[]};function l(t){c=a(c,t),o.forEach(t=>{t(c)})}function d(t){let{...e}=t,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>l({type:"DISMISS_TOAST",toastId:s});return l({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:t=>{t||n()}}}),{id:s,dismiss:n,update:t=>l({type:"UPDATE_TOAST",toast:{...t,id:s}})}}function h(){let[t,e]=n.useState(c);return n.useEffect(()=>(o.push(e),()=>{let t=o.indexOf(e);t>-1&&o.splice(t,1)}),[t]),{...t,toast:d,dismiss:t=>l({type:"DISMISS_TOAST",toastId:t})}}},1072:function(t,e,s){"use strict";s.d(e,{O:function(){return o}});var n=s(39683),r=s(40257);let i=r.env.VITE_SUPABASE_URL||"https://vnwzwdzsaciylaihuhbd.supabase.co",u=r.env.VITE_SUPABASE_PUBLISHABLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZud3p3ZHpzYWNpeWxhaWh1aGJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4Mjk4NTYsImV4cCI6MjA3NTQwNTg1Nn0.uL1EzQJ6LKSa5k0jnbI4FYG1V0Z-cwdABBWJRJ79Jjs",a=localStorage,o=(0,n.eI)(String(i),String(u),{auth:{storage:a,persistSession:!0,autoRefreshToken:!0}})}},function(t){t.O(0,[683,971,117,744],function(){return t(t.s=16469)}),_N_E=t.O()}]);